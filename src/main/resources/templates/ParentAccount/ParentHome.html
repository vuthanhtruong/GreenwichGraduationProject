<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Your Children</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    <link rel="stylesheet" th:href="@{/StudentsList.css}"/>
</head>

<body>
<div class="win11-container">

    <div class="search-toolbar unified-bar">

        <!-- Left -->
        <div class="toolbar-left">
            <h2 class="page-title">
                <i class="fas fa-user-graduate"></i> Your Children
            </h2>
        </div>

        <a th:href="@{/parent/personal-page}"
           class="btn small info"
           style="display:flex; align-items:center; gap:6px;">
            <i class="fas fa-id-card"></i> Personal Page
        </a>


        <!-- Right: Parent Info + Logout -->
        <div class="toolbar-right" style="display:flex; align-items:center; gap:20px;">
            <!-- Logout button -->
            <form th:action="@{/logout}" method="post" style="margin:0;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn small danger" style="display:flex; align-items:center; gap:6px;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </form>

        </div>
    </div>

    <!-- Students Table -->
    <div class="table-container">
        <table class="win11-table">

            <!-- Header -->
            <thead>
            <tr>
                <th><i class="fas fa-id-card"></i> ID</th>
                <th><i class="fas fa-image"></i> Avatar</th>
                <th><i class="fas fa-user"></i> Full Name</th>
                <th><i class="fas fa-envelope"></i> Email</th>
                <th><i class="fas fa-calendar-week"></i> Timetable</th>
                <th><i class="fas fa-chart-line"></i> Learning Process</th>
                <th><i class="fas fa-file-certificate"></i> Academic Transcript</th>
                <th><i class="fas fa-receipt"></i> Payment History</th>
            </tr>
            </thead>

            <!-- Body -->
            <tbody>
            <tr th:each="student : ${students}">

                <td th:text="${student.id}"></td>

                <!-- Avatar -->
                <td>
                    <img th:if="${student.avatar != null}"
                         th:src="@{'/staff-home/students-list/avatar/' + ${student.id}}"
                         class="avatar"
                         th:alt="${student.fullName}"/>

                    <img th:if="${student.avatar == null}"
                         th:src="${student.defaultAvatarPath}"
                         class="avatar"
                         th:alt="${student.fullName}"/>
                </td>

                <td th:text="${student.firstName + ' ' + student.lastName}"></td>
                <td th:text="${student.email}"></td>

                <!-- Timetable -->
                <td>
                    <form method="post" th:action="@{/parent/timetable}">
                        <input type="hidden" name="studentId" th:value="${student.id}"/>
                        <button class="btn primary small">
                            <i class="fas fa-calendar-week"></i> View Timetable
                        </button>
                    </form>
                </td>

                <!-- Learning Process -->
                <td>
                    <form method="post" th:action="@{/parent/learning-process}">
                        <input type="hidden" name="studentId" th:value="${student.id}"/>
                        <button class="btn secondary small">
                            <i class="fas fa-chart-line"></i> View Learning Process
                        </button>
                    </form>
                </td>

                <!-- Transcript -->
                <td>
                    <form method="post" th:action="@{/parent/transcript}">
                        <input type="hidden" name="studentId" th:value="${student.id}"/>
                        <button class="btn info small">
                            <i class="fas fa-file-certificate"></i> View Transcript
                        </button>
                    </form>
                </td>

                <td>
                    <form method="post" th:action="@{/parent/payment-history}">
                        <input type="hidden" name="studentId" th:value="${student.id}"/>
                        <button class="btn dark small">
                            <i class="fas fa-receipt"></i> View Payment History
                        </button>
                    </form>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(students)}">
                <td colspan="7" class="text-center">
                    <i class="fas fa-info-circle"></i> No children found.
                </td>
            </tr>

            </tbody>

        </table>
    </div>

</div>
</body>
</html>
