<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List of Rooms</title>
    <link rel="stylesheet" th:href="@{/ListRooms.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
</head>
<body>
<div class="win11-container">

    <!-- Unified Toolbar -->
    <div class="search-toolbar unified-bar">
        <!-- Left: Home -->
        <div class="toolbar-left">
            <a th:href="@{/admin-home}" class="btn home-btn">
                <i class="fas fa-home"></i> Home
            </a>
        </div>

        <!-- Center: Title -->
        <div class="toolbar-center">
            <h2 class="page-title">
                <i class="fas fa-building"></i> List of Rooms
            </h2>
        </div>

        <!-- Right: Actions -->
        <div class="toolbar-right">
            <button type="button" class="btn primary" onclick="openOnlineOverlay()">
                <i class="fas fa-video"></i> Add Online Room
            </button>
            <button type="button" class="btn primary" onclick="openOfflineOverlay()">
                <i class="fas fa-building"></i> Add Offline Room
            </button>
        </div>
    </div>


    <!-- Online Rooms -->
        <section class="win11-panel">
            <h2 class="panel-header">Online Rooms</h2>
            <div class="room-grid">
                <div th:unless="${onlineRooms.size() > 0}">
                    <p class="text-center">No online rooms available.</p>
                </div>
                <div class="room-card" th:each="room : ${onlineRooms}">
                    <div class="avatar-container">
                        <img th:src="@{/admin-home/rooms-list/avatar/{roomId}(roomId=${room.roomId})}"
                             class="room-avatar"
                             alt="Room Avatar"
                             onerror="this.src='/DefaultAvatar/default-online-room.png'">
                    </div>
                    <h3 th:text="${room.roomName}" class="room-title"></h3>
                    <p><strong>ID:</strong> <span th:text="${room.roomId}"></span></p>
                    <p><strong>Link:</strong> <a th:href="${room.link}" th:text="${room.link}"></a></p>
                    <p><strong>Created At:</strong> <span th:text="${room.createdAt}"></span></p>
                    <p><strong>Creator:</strong> <span th:text="${room.creator?.id} ?: 'N/A'"></span></p>
                    <div class="form-actions">
                        <form th:action="@{/admin-home/rooms-list/edit-online-room-form}" method="post">
                            <input type="hidden" name="id" th:value="${room.roomId}">
                            <button type="submit" class="btn"><i class="fas fa-edit"></i> Edit</button>
                        </form>
                        <form th:action="@{/admin-home/rooms-list/delete-online-room}" method="post">
                            <input type="hidden" name="id" th:value="${room.roomId}">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                            <button type="submit" class="btn danger" onclick="return confirm('Are you sure you want to delete this online room?');">
                                <i class="fas fa-trash-alt"></i> Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Offline Rooms -->
        <section class="win11-panel">
            <h2 class="panel-header">Offline Rooms</h2>
            <div class="room-grid">
                <div th:unless="${offlineRooms.size() > 0}">
                    <p class="text-center">No offline rooms available.</p>
                </div>
                <div class="room-card" th:each="room : ${offlineRooms}">
                    <div class="avatar-container">
                        <img th:src="@{/admin-home/rooms-list/avatar/{roomId}(roomId=${room.roomId})}"
                             class="room-avatar"
                             alt="Room Avatar"
                             onerror="this.src='/DefaultAvatar/default-room.png'">
                    </div>
                    <h3 th:text="${room.roomName}" class="room-title"></h3>
                    <p><strong>ID:</strong> <span th:text="${room.roomId}"></span></p>
                    <p><strong>Address:</strong> <span th:text="${room.address} ?: 'N/A'"></span></p>
                    <p><strong>Created At:</strong> <span th:text="${room.createdAt}"></span></p>
                    <p><strong>Creator:</strong> <span th:text="${room.creator?.id} ?: 'N/A'"></span></p>
                    <div class="form-actions">
                        <form th:action="@{/admin-home/rooms-list/edit-offline-room-form}" method="post">
                            <input type="hidden" name="id" th:value="${room.roomId}">
                            <button type="submit" class="btn"><i class="fas fa-edit"></i> Edit</button>
                        </form>
                        <form th:action="@{/admin-home/rooms-list/delete-offline-room}" method="post">
                            <input type="hidden" name="id" th:value="${room.roomId}">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                            <button type="submit" class="btn danger" onclick="return confirm('Are you sure you want to delete this offline room?');">
                                <i class="fas fa-trash-alt"></i> Delete
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

    </div>
</div>

<!-- Overlay Add Online Room -->
<div id="addOnlineOverlay" class="overlay">
    <div class="overlay-content">
        <h2><i class="fas fa-plus-circle"></i> Add New Online Room</h2>
        <form method="post" th:action="@{/admin-home/rooms-list/add-online-room}" th:object="${onlineRoom}" enctype="multipart/form-data" class="form-group grid-2">
            <div class="form-row">
                <label for="roomNameOnline">Room Name:</label>
                <input id="roomNameOnline" class="input" th:field="*{roomName}" type="text" required>
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('roomName')}" th:text="${error}"></div>
            </div>
            <div class="form-row">
                <label for="link">Link (optional):</label>
                <input id="link" class="input" name="link" type="text">
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('link')}" th:text="${error}"></div>
            </div>
            <div class="form-row">
                <label for="avatarOnline">Avatar (optional):</label>
                <input id="avatarOnline" class="input" type="file" name="avatarFile" accept="image/*">
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('avatar')}" th:text="${error}"></div>
            </div>
            <div class="form-actions">
                <button class="btn primary" type="submit">
                    <i class="fas fa-save"></i> Save Room
                </button>
                <button type="button" class="btn danger" onclick="closeOnlineOverlay()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </form>
    </div>
</div>

<!-- Overlay Add Offline Room -->
<div id="addOfflineOverlay" class="overlay">
    <div class="overlay-content">
        <h2><i class="fas fa-plus-circle"></i> Add New Offline Room</h2>
        <form method="post" th:action="@{/admin-home/rooms-list/add-offline-room}" th:object="${offlineRoom}" enctype="multipart/form-data" class="form-group grid-2">
            <div class="form-row">
                <label for="roomNameOffline">Room Name:</label>
                <input id="roomNameOffline" class="input" th:field="*{roomName}" type="text" required>
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('roomName')}" th:text="${error}"></div>
            </div>
            <div class="form-row">
                <label for="address">Address (optional):</label>
                <input id="address" class="input" name="address" type="text">
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('address')}" th:text="${error}"></div>
            </div>
            <div class="form-row">
                <label for="floor">Floor (optional):</label>
                <input id="floor" class="input" name="floor" type="number" th:value="${offlineRoom.floor}">
                <div class="error-text" th:each="error : ${errors}" th:if="${error.key == 'floor'}" th:text="${error.value}"></div>
            </div>
            <div class="form-row">
                <label for="avatarOffline">Avatar (optional):</label>
                <input id="avatarOffline" class="input" type="file" name="avatarFile" accept="image/*">
                <div class="error-text" th:each="error : ${errors}" th:if="${error.contains('avatar')}" th:text="${error}"></div>
            </div>
            <div class="form-actions">
                <button class="btn primary" type="submit">
                    <i class="fas fa-save"></i> Save Room
                </button>
                <button type="button" class="btn danger" onclick="closeOfflineOverlay()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        </form>
    </div>
</div>

<script>
    function openOnlineOverlay() {
        document.getElementById('addOnlineOverlay').classList.add('active');
    }
    function closeOnlineOverlay() {
        document.getElementById('addOnlineOverlay').classList.remove('active');
    }
    function openOfflineOverlay() {
        document.getElementById('addOfflineOverlay').classList.add('active');
    }
    function closeOfflineOverlay() {
        document.getElementById('addOfflineOverlay').classList.remove('active');
    }
</script>
<script th:if="${openOnlineOverlay}">
    document.addEventListener("DOMContentLoaded", function () {
        openOnlineOverlay();
    });
</script>
<script th:if="${openOfflineOverlay}">
    document.addEventListener("DOMContentLoaded", function () {
        openOfflineOverlay();
    });
</script>
</body>
</html>